drop  PROCEDURE idle_shipProcedure;
create or replace PROCEDURE idle_shipProcedure( p_username VARCHAR)
 AS

BEGIN

FOR i IN(select MMSI,departure_date
FROM TRIP t
INNER JOIN LOCATION l ON l.TRIP_ID = t.TRIP_ID
INNER JOIN STAFF s  ON s.location_ID = s.location_ID
INNER JOIN userr u  ON u.staff_ID = u.staff_ID
WHERE EXTRACT(YEAR FROM departure_date)='2022' and u.username = p_username
)

LOOP 
DBMS_OUTPUT.PUT_LINE( 'mmsi =  ' || i.MMSI || '     idle days : '|| to_CHAR(trunc(i.departure_date) -to_date('01-01-2022','MM/DD/YYYY')));
END LOOP;

END;

EXECUTE idle_shipProcedure(484186);

INSERT INTO VEHICLE VALUES (123);
INSERT INTO VEHICLE VALUES (234);
INSERT INTO VEHICLE VALUES(50);

INSERT INTO SHIP VALUES (238756490, 'IMO1234567', 1111111, 97,'HELLO', 10, 12.3, 70, 294, 13, 123);
INSERT INTO SHIP VALUES (192837465, 'IMO2345678', 1111112, 80,'BYE', 20, 18.3, 90, 494, 10, 234);
INSERT INTO SHIP VALUES (192837777, 'IMO2349878', 1111113, 80,'Bhtbj', 20, 18.7, 90, 494, 10, 50);

INSERT INTO TRIP VALUES(1234, 123, 238756490 ,'LISBON', 'FARO', '2022-01-25', '2022-01-28');
INSERT INTO TRIP VALUES(2345, 234, 192837465 ,'LEIXOES', 'LISBON', '2022-01-10', '2022-01-27');
INSERT INTO TRIP VALUES(3456, 50, 192837777 ,'LISBON', 'MADRID', '2022-01-6', '2022-01-28');

INSERT INTO STOPS VALUES ('CASCAIS', 1234, '2022-01-27','2022-01-27');
INSERT INTO STOPS VALUES ('COIMBRA', 2345, '2022-01-27','2022-01-26');
INSERT INTO STOPS VALUES ('SEVILLA', 3456, '2022-01-28', '2022-01-27');

INSERT INTO CONTINENT VALUES('EUROPE');

INSERT INTO POSITION VALUES('55', 38.716, 9.16);
INSERT INTO POSITION VALUES('54', 38.716, 9.16);
INSERT INTO POSITION VALUES('99', 39.234, 10.28);

INSERT INTO COUNTRY VALUES('EUROPE', 'PT', 'PRT', 'PORTUGAL', 10.31, 'LISBON', 38.716, 9.16);
INSERT INTO COUNTRY VALUES('EUROPE', 'ES', 'ESP', 'SPAIN', 20.31, 'MADRID', 39.234, 10.28);

INSERT INTO LOCATION VALUES(55,'CASCAIS', 55, 'PORTUGAL', 'PORT', 1234, 20);
INSERT INTO LOCATION VALUES(54,'COIMBRA', 54, 'PORTUGAL', 'PORT', 2345, 15);
INSERT INTO LOCATION VALUES(99,'SEVILLA', 99, 'SPAIN', 'WAREHOUSE', 3456, 100);

INSERT INTO CARGO_MANIFEST VALUES (23, 5, '2022-01-25', 'LOADED', 55, 'CASCAIS', 123);
INSERT INTO CARGO_MANIFEST VALUES (24, 7, '2022-01-26', 'UNLOADED', 54, 'COIMBRA', 234);
INSERT INTO CARGO_MANIFEST VALUES (25, 8, '2022-01-27', 'UNLOADED', 99, 'SEVILLA', 50);


INSERT INTO CONTAINER VALUES (99, 124.2, 198.2, 876.4, 'REFRIG', 12);
INSERT INTO CONTAINER VALUES (100, 100.2, 100.2, 900.4, 'NOTREFRIG', 15);
INSERT INTO CONTAINER VALUES (101, 150.2, 99.2, 500.4, 'NOTREFRIG', 16);

INSERT INTO CONTAINER VALUES (11, 124.2, 198.2, 876.4, 'REFRIG', 12);
INSERT INTO CONTAINER VALUES (12, 100.2, 100.2, 900.4, 'NOTREFRIG', 15);
INSERT INTO CONTAINER VALUES (13, 150.2, 99.2, 500.4, 'NOTREFRIG', 16);

INSERT INTO SHIP_CONTAINER VALUES (99, 238756490);
INSERT INTO SHIP_CONTAINER VALUES (100, 238756490);
INSERT INTO SHIP_CONTAINER VALUES (101, 238756490);

INSERT INTO SHIP_CONTAINER VALUES (11, 192837465);
INSERT INTO SHIP_CONTAINER VALUES (12, 192837465);
INSERT INTO SHIP_CONTAINER VALUES (13, 192837465);

INSERT INTO CONTAINER_CARGO_MANIFEST VALUES (99, 23, 1,1,1, 'FARO');
INSERT INTO CONTAINER_CARGO_MANIFEST VALUES (100, 23, 2,1,1, 'FARO');
INSERT INTO CONTAINER_CARGO_MANIFEST VALUES (101, 23, 3,1,1, 'FARO');

INSERT INTO CONTAINER_CARGO_MANIFEST VALUES (11, 24, 1,1,1, 'LISBON');
INSERT INTO CONTAINER_CARGO_MANIFEST VALUES (12, 24, 2,1,1, 'LISBON');
INSERT INTO CONTAINER_CARGO_MANIFEST VALUES (13, 24, 3,1,1, 'LISBON');

INSERT INTO STAFF VALUES(9876,'JOAO', 23, 55, 'CASCAIS');
INSERT INTO STAFF VALUES(3456,'ALBERTO', 24, 54, 'COIMBRA');

INSERT INTO ROLE VALUES('project_manager');
INSERT INTO ROLE VALUES('fleet_manager');

INSERT INTO USERR VALUES(484185,'JHFEH', 'project_manager', 3456);
INSERT INTO USERR VALUES(484186,'ALJHO', 'fleet_manager',9876);






INSERT INTO VEHICLE VALUES (123);
INSERT INTO VEHICLE VALUES (234);
INSERT INTO VEHICLE VALUES(50);

INSERT INTO SHIP VALUES (238756490, 'IMO1234567', 1111111, 97,'HELLO', 10, 12.3, 70, 294, 13, 123);
INSERT INTO SHIP VALUES (192837465, 'IMO2345678', 1111112, 80,'BYE', 20, 18.3, 90, 494, 10, 234);
INSERT INTO SHIP VALUES (192837777, 'IMO2349878', 1111113, 80,'Bhtbj', 20, 18.7, 90, 494, 10, 50);

INSERT INTO TRIP VALUES(1234, 123, 238756490 ,'LISBON', 'FARO', '2022-01-25', '2022-01-28');
INSERT INTO TRIP VALUES(2345, 234, 192837465 ,'LEIXOES', 'LISBON', '2022-01-10', '2022-01-27');
INSERT INTO TRIP VALUES(3456, 50, 192837777 ,'LISBON', 'MADRID', '2022-01-6', '2022-01-28');

INSERT INTO STOPS VALUES ('CASCAIS', 1234, '2022-01-27','2022-01-27');
INSERT INTO STOPS VALUES ('COIMBRA', 2345, '2022-01-27','2022-01-26');
INSERT INTO STOPS VALUES ('SEVILLA', 3456, '2022-01-28', '2022-01-27');

INSERT INTO CONTINENT VALUES('EUROPE');

INSERT INTO POSITION VALUES('55', 38.716, 9.16);
INSERT INTO POSITION VALUES('54', 38.716, 9.16);
INSERT INTO POSITION VALUES('99', 39.234, 10.28);

INSERT INTO COUNTRY VALUES('EUROPE', 'PT', 'PRT', 'PORTUGAL', 10.31, 'LISBON', 38.716, 9.16);
INSERT INTO COUNTRY VALUES('EUROPE', 'ES', 'ESP', 'SPAIN', 20.31, 'MADRID', 39.234, 10.28);

INSERT INTO LOCATION VALUES(55,'CASCAIS', 55, 'PORTUGAL', 'PORT', 1234, 20);
INSERT INTO LOCATION VALUES(54,'COIMBRA', 54, 'PORTUGAL', 'PORT', 2345, 15);
INSERT INTO LOCATION VALUES(99,'SEVILLA', 99, 'SPAIN', 'WAREHOUSE', 3456, 100);

INSERT INTO CARGO_MANIFEST VALUES (23, 5, '2022-01-25', 'LOADED', 55, 'CASCAIS', 123);
INSERT INTO CARGO_MANIFEST VALUES (24, 7, '2022-01-26', 'UNLOADED', 54, 'COIMBRA', 234);
INSERT INTO CARGO_MANIFEST VALUES (25, 8, '2022-01-27', 'UNLOADED', 99, 'SEVILLA', 50);


INSERT INTO CONTAINER VALUES (99, 124.2, 198.2, 876.4, 'REFRIG', 12);
INSERT INTO CONTAINER VALUES (100, 100.2, 100.2, 900.4, 'NOTREFRIG', 15);
INSERT INTO CONTAINER VALUES (101, 150.2, 99.2, 500.4, 'NOTREFRIG', 16);

INSERT INTO CONTAINER VALUES (11, 124.2, 198.2, 876.4, 'REFRIG', 12);
INSERT INTO CONTAINER VALUES (12, 100.2, 100.2, 900.4, 'NOTREFRIG', 15);
INSERT INTO CONTAINER VALUES (13, 150.2, 99.2, 500.4, 'NOTREFRIG', 16);

INSERT INTO SHIP_CONTAINER VALUES (99, 238756490);
INSERT INTO SHIP_CONTAINER VALUES (100, 238756490);
INSERT INTO SHIP_CONTAINER VALUES (101, 238756490);

INSERT INTO SHIP_CONTAINER VALUES (11, 192837465);
INSERT INTO SHIP_CONTAINER VALUES (12, 192837465);
INSERT INTO SHIP_CONTAINER VALUES (13, 192837465);

INSERT INTO CONTAINER_CARGO_MANIFEST VALUES (99, 23, 1,1,1, 'FARO');
INSERT INTO CONTAINER_CARGO_MANIFEST VALUES (100, 23, 2,1,1, 'FARO');
INSERT INTO CONTAINER_CARGO_MANIFEST VALUES (101, 23, 3,1,1, 'FARO');

INSERT INTO CONTAINER_CARGO_MANIFEST VALUES (11, 24, 1,1,1, 'LISBON');
INSERT INTO CONTAINER_CARGO_MANIFEST VALUES (12, 24, 2,1,1, 'LISBON');
INSERT INTO CONTAINER_CARGO_MANIFEST VALUES (13, 24, 3,1,1, 'LISBON');

INSERT INTO STAFF VALUES(9876,'JOAO', 23, 55, 'CASCAIS');
INSERT INTO STAFF VALUES(9806,'ALDO', 24, 54, 'Coimbra');

INSERT INTO ROLE VALUES('fleet_manager');
INSERT INTO ROLE VALUES('captain');

INSERT INTO USERR VALUES(484186,'ALJHO', 'fleet_manager',9876);
INSERT INTO USERR VALUES(765432,'ALPIO', 'captain',9806);